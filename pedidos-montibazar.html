<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Montibazar - Realizar Pedido</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 32px;
        }
        
        .subtitle {
            color: #666;
            margin-bottom: 30px;
        }
        
        .form-section {
            margin-bottom: 30px;
        }
        
        .form-section h2 {
            color: #333;
            margin-bottom: 15px;
            font-size: 20px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
        }
        
        input[type="text"],
        input[type="email"],
        input[type="tel"],
        textarea,
        select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        input:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .category-filter {
            margin-bottom: 20px;
        }
        
        .product-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .product-info {
            flex: 1;
        }
        
        .product-name {
            font-weight: 600;
            color: #333;
            font-size: 16px;
            margin-bottom: 3px;
        }
        
        .product-price {
            color: #667eea;
            font-size: 18px;
            font-weight: 700;
        }
        
        .quantity-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .qty-btn {
            background: #667eea;
            color: white;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 8px;
            font-size: 20px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .qty-btn:hover {
            background: #5568d3;
        }
        
        .qty-input {
            width: 60px;
            text-align: center;
            padding: 8px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
        }
        
        .total-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin: 30px 0;
            text-align: center;
        }
        
        .total-label {
            font-size: 18px;
            margin-bottom: 10px;
        }
        
        .total-amount {
            font-size: 48px;
            font-weight: 700;
        }
        
        .submit-btn {
            width: 100%;
            background: #667eea;
            color: white;
            border: none;
            padding: 18px;
            font-size: 18px;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .submit-btn:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        
        .submit-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .success-message, .error-message {
            display: none;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            margin-top: 20px;
            font-size: 18px;
        }
        
        .success-message {
            background: #4caf50;
            color: white;
        }
        
        .error-message {
            background: #f44336;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üõí Montibazar</h1>
        <p class="subtitle">Completa tu pedido f√°cilmente</p>
        
        <form id="orderForm">
            <div class="form-section">
                <h2>üìã Tus Datos</h2>
                <div class="form-group">
                    <label for="nombre">Nombre Completo *</label>
                    <input type="text" id="nombre" required>
                </div>
                <div class="form-group">
                    <label for="correo">Correo Electr√≥nico *</label>
                    <input type="email" id="correo" required>
                </div>
                <div class="form-group">
                    <label for="telefono">Tel√©fono / WhatsApp *</label>
                    <input type="tel" id="telefono" required>
                </div>
                <div class="form-group">
                    <label for="direccion">Direcci√≥n de Entrega *</label>
                    <input type="text" id="direccion" required>
                </div>
            </div>
            
            <div class="form-section">
                <h2>üì¶ Selecciona tus Productos</h2>
                <div class="category-filter">
                    <label for="categoria">Filtrar por categor√≠a:</label>
                    <select id="categoria">
                        <option value="todos">Todos los productos</option>
                        <option value="hogar">Hogar</option>
                        <option value="parlantes">Parlantes</option>
                        <option value="luminarias">Luminarias</option>
                        <option value="juegos">Juegos</option>
                        <option value="novedades">Novedades</option>
                    </select>
                </div>
                <div id="productsList"></div>
            </div>
            
            <div class="total-section">
                <div class="total-label">Total a pagar:</div>
                <div class="total-amount">S/. <span id="totalAmount">0</span></div>
            </div>
            
            <div class="form-section">
                <h2>üí¨ Comentarios (Opcional)</h2>
                <textarea id="comentarios" rows="3" placeholder="¬øAlguna indicaci√≥n especial?"></textarea>
            </div>
            
            <button type="submit" class="submit-btn">Enviar Pedido</button>
        </form>
        
        <div class="success-message" id="successMessage">
            ‚úÖ ¬°Pedido enviado! Recibir√°s un correo de confirmaci√≥n pronto.
        </div>
        <div class="error-message" id="errorMessage">
            ‚ùå Error al enviar. Por favor, intenta nuevamente.
        </div>
    </div>

    <script>
        const productos = [
            {nombre: "SET CUCHILLOS DE COCINA 9 PIEZAS", precio: 99, categoria: "hogar"},
            {nombre: "PLANCHA ELECTRICA DE ROPA", precio: 110, categoria: "hogar"},
            {nombre: "SANDWICHERA 800W", precio: 98, categoria: "hogar"},
            {nombre: "BATIDORA DE MANO ELECTRICA 600W", precio: 96, categoria: "hogar"},
            {nombre: "CAFETERA ELECTRICA 625mL", precio: 126, categoria: "hogar"},
            {nombre: "LICUADORA STARLUX 2 EN 1", precio: 126, categoria: "hogar"},
            {nombre: "HERVIDOR ELECTRICO 2.5L", precio: 72, categoria: "hogar"},
            {nombre: "MAQUINA TOSTADORA 650W", precio: 110, categoria: "hogar"},
            {nombre: "MAQUINA CORTADORA DE CABELLO", precio: 110, categoria: "novedades"},
            {nombre: "MAQUINA CORTADORA DE PELO RECARGABLE", precio: 93, categoria: "novedades"},
            {nombre: "PARLANTE G BT 2301", precio: 57, categoria: "parlantes"},
            {nombre: "MINI PARLANTE BLUETOOTH WIND 3S", precio: 63, categoria: "parlantes"},
            {nombre: "MINI PARLANTE CON LUZ LED", precio: 57, categoria: "parlantes"},
            {nombre: "PARLANTE 4 PULGADAS CON LUZ RGB", precio: 63, categoria: "parlantes"},
            {nombre: "HIELERA PARLANTE BLUETOOTH", precio: 57, categoria: "parlantes"},
            {nombre: "FOCO LAMPARA SOLAR 30W", precio: 57, categoria: "luminarias"},
            {nombre: "FOCO LED A COLORES MUSICAL", precio: 72, categoria: "luminarias"},
            {nombre: "LUZ LED SOLAR CON SENSOR", precio: 41, categoria: "luminarias"},
            {nombre: "LAMPARA MATA MOSQUITOS 2 EN 1", precio: 65, categoria: "luminarias"},
            {nombre: "CONSOLA DE JUEGOS 3D GAMES 5G", precio: 247, categoria: "juegos"},
            {nombre: "CONSOLA DE JUEGO 20000 JUEGOS", precio: 124, categoria: "juegos"},
            {nombre: "CONSOLA CON MANDOS RECARGABLES", precio: 220, categoria: "juegos"},
            {nombre: "HIDROLAVADORA 48V", precio: 124, categoria: "novedades"},
            {nombre: "INTERCOMUNICADOR PARA CASCO", precio: 140, categoria: "novedades"},
            {nombre: "MORRAL FASHION ANTIROBO", precio: 49, categoria: "novedades"}
        ];
        
        const WEBHOOK_URL = 'https://hook.us2.make.com/7qyang1uvx43d3n5c78hdxo39ew1b7n8';
        
        let cantidades = {};
        let todosProductos = [];
        
        function renderProductos(filtro = 'todos') {
            const container = document.getElementById('productsList');
            container.innerHTML = '';
            
            const productosFiltrados = filtro === 'todos' 
                ? productos 
                : productos.filter(p => p.categoria === filtro);
            
            productosFiltrados.forEach((producto, index) => {
                const globalIndex = productos.indexOf(producto);
                if (!cantidades[globalIndex]) cantidades[globalIndex] = 0;
                
                const div = document.createElement('div');
                div.className = 'product-item';
                div.innerHTML = `
                    <div class="product-info">
                        <div class="product-name">${producto.nombre}</div>
                        <div class="product-price">S/. ${producto.precio}</div>
                    </div>
                    <div class="quantity-control">
                        <button type="button" class="qty-btn" onclick="updateQuantity(${globalIndex}, -1)">‚àí</button>
                        <input type="number" class="qty-input" id="qty-${globalIndex}" value="${cantidades[globalIndex]}" min="0" readonly>
                        <button type="button" class="qty-btn" onclick="updateQuantity(${globalIndex}, 1)">+</button>
                    </div>
                `;
                container.appendChild(div);
            });
        }
        
        function updateQuantity(index, change) {
            cantidades[index] = Math.max(0, (cantidades[index] || 0) + change);
            const input = document.getElementById(`qty-${index}`);
            if (input) input.value = cantidades[index];
            calcularTotal();
        }
        
        function calcularTotal() {
            let total = 0;
            productos.forEach((producto, index) => {
                total += producto.precio * (cantidades[index] || 0);
            });
            document.getElementById('totalAmount').textContent = total.toFixed(0);
        }
        
        document.getElementById('categoria').addEventListener('change', (e) => {
            renderProductos(e.target.value);
        });
        
        document.getElementById('orderForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const nombre = document.getElementById('nombre').value;
            const correo = document.getElementById('correo').value;
            const telefono = document.getElementById('telefono').value;
            const direccion = document.getElementById('direccion').value;
            const comentarios = document.getElementById('comentarios').value;
            
            let productosSeleccionados = [];
            let total = 0;
            productos.forEach((producto, index) => {
                if ((cantidades[index] || 0) > 0) {
                    productosSeleccionados.push(`${cantidades[index]}x ${producto.nombre} (S/. ${producto.precio * cantidades[index]})`);
                    total += producto.precio * cantidades[index];
                }
            });
            
            if (productosSeleccionados.length === 0) {
                alert('Por favor selecciona al menos un producto');
                return;
            }
            
            const data = {
                cliente: nombre,
                correo: correo,
                telefono: telefono,
                direccion: direccion,
                productos: productosSeleccionados.join(', '),
                total: total.toString(),
                comentarios: comentarios
            };
            
            try {
                const response = await fetch(WEBHOOK_URL, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(data)
                });
                
                if (response.ok) {
                    document.getElementById('successMessage').style.display = 'block';
                    document.getElementById('orderForm').reset();
                    cantidades = {};
                    renderProductos();
                    calcularTotal();
                    setTimeout(() => {
                        document.getElementById('successMessage').style.display = 'none';
                    }, 5000);
                } else {
                    throw new Error('Error');
                }
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('errorMessage').style.display = 'block';
                setTimeout(() => {
                    document.getElementById('errorMessage').style.display = 'none';
                }, 5000);
            }
        });
        
        renderProductos();
    </script>
</body>
</html>

